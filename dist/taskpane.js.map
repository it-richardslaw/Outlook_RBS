{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-react-js/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://office-addin-taskpane-react-js/./node_modules/react-dom/client.js","webpack://office-addin-taskpane-react-js/./node_modules/prop-types/index.js","webpack://office-addin-taskpane-react-js/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://office-addin-taskpane-react-js/./src/taskpane/components/AppContext.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/components/Header.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/components/App.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/index.jsx"],"sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","import { createContext } from \"react\";\r\n\r\nexport const AppContext = createContext({\r\n  isDark: false,\r\n  colors: {},\r\n  caseId: \"\",\r\n  setCaseId: () => {},\r\n});","import React, { useState } from 'react';\nimport { AppContext } from './AppContext';\n\n// --- Header Component (Adapted for compatibility) ---\nconst Header = ({ title, logo, message }) => {\n  const { colors } = React.useContext(AppContext); \n  // Styles translated from the Fluent UI \"makeStyles\" request\n  const headerStyle = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    paddingTop: \"10px\",\n    backgroundColor: \"transparent\", \n    width: \"100%\",\n  };\n\n  const messageStyle = {\n    marginTop: \"5px\",\n    marginBottom: \"15px\",\n    fontSize: \"42px\", \n    fontWeight: \"400\", \n    color: colors.textColor,\n    textAlign: \"center\",\n    fontFamily: \"'Segoe UI', sans-serif\",\n  };\n\n  return (\n    <section style={headerStyle}>\n      <img \n        src={logo} \n        alt={title} \n        style={{ width: \"90px\", height: \"auto\" }}\n        onError={(e) => {\n          e.target.onerror = null; \n          e.target.style.display = 'none';\n          e.target.parentNode.innerHTML += '<span style=\"font-size: 50px;\">⚖️</span>'; \n        }}\n      />\n      <h1 style={messageStyle}>{message}</h1>\n    </section>\n  );\n};\n\nexport default Header;","import * as React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Header from \"./Header\";\nimport AddNoteForm from \"./AddNoteForm\";\nimport { AppContext } from \"./AppContext\";\nimport AttachmentsList from \"./AttachmentsList\";\n\nfunction isDarkTheme() {\n  return typeof window !== \"undefined\" && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n}\n\nconst App = (props) => {\n  const { title } = props;\n  const [isDark, setIsDark] = useState(isDarkTheme());\n  const [attachments, setAttachments] = useState([]);\n  const [caseId, setCaseId] = useState(\"\");\n  const [officeReady, setOfficeReady] = useState(false);\n  const [item, setItem] = useState(null);\n  const [isComposeMode, setIsComposeMode] = useState(false);\n\n  useEffect(() => {\n    Office.onReady(() => {\n      setOfficeReady(true);\n    });\n  }, []);\n\n  useEffect(() => {\n    const media = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    const handleChange = (e) => {\n      setIsDark(e.matches);\n    };\n    media.addEventListener(\"change\", handleChange);\n    return () => media.removeEventListener(\"change\", handleChange);\n  }, []);\n\n  useEffect(() => {\n    const handler = () => {\n      const currentItem = Office.context.mailbox.item;\n      if (!currentItem) {\n        setAttachments([]);\n        return;\n      }\n\n      setItem(currentItem);\n      const isCompose =\n        currentItem.itemType === Office.MailboxEnums.ItemType.Message &&\n        typeof currentItem.body?.setAsync === \"function\";\n      setIsComposeMode(isCompose);\n\n      if (!currentItem.attachments) {\n        setAttachments([]);\n        return;\n      }\n\n      const mappedAttachments = currentItem.attachments\n        .filter((att) => !att.isInline)\n        .map((att, index) => ({\n          id: att.id || index,\n          name: att.name,\n          size: att.size || 0,\n        }));\n      setAttachments(mappedAttachments);\n    };\n\n    handler();\n\n    Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, handler);\n\n    return () => Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged, handler);\n  }, []);\n\n  const colors = {\n    primaryColor: \"#1070e0\",\n    primaryColorHover: \"#0d5fb5\",\n    backgroundColor: isDark ? \"#1f1f1f\" : \"#f5f5f5\",\n    cardBackground: isDark ? \"#2d2d2d\" : \"#fff\",\n    textColor: isDark ? \"#f0f0f0\" : \"#333\",\n    labelColor: isDark ? \"#ccc\" : \"#555\",\n    borderColor: isDark ? \"#444\" : \"#d1d9e6\",\n    boxShadow: isDark ? \"0 6px 20px rgba(0,0,0,0.3)\" : \"0 6px 20px rgba(0,0,0,0.05)\",\n    inputColor: isDark ? \"#e0e0e0\" : \"#333\",\n    inputBg: isDark ? \"#3c3c3c\" : \"#fff\",\n    resultErrorColor: isDark ? \"#ff7f7f\" : \"#d32f2f\",\n    resultSuccessColor: isDark ? \"#90ee90\" : \"#2e7d32\",\n    warningColor: isDark ? \"#ffeb3b\" : \"#ff9800\",\n    warningBg: isDark ? \"#4c3f00\" : \"#fff3e0\",\n    listBg: isDark ? \"#242424\" : \"#f9f9f9\",\n    listBorder: isDark ? \"#333\" : \"#eee\",\n    spinnerBorder: isDark ? \"#555\" : \"#f3f3f3\",\n    spinnerBorderTop: \"#fff\",\n  };\n\n  if (!officeReady) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <AppContext.Provider\n      value={{ isDark, colors, caseId, setCaseId, item, setItem, isComposeMode, attachments }}\n    >\n      <div style={{ backgroundColor: \"transparent\", minHeight: \"100vh\" }}>\n        <Header logo=\"assets/logo-filled.png\" title={title} message=\"Richards Law\" />\n        {/* <AddNoteForm /> */}\n        {/* <AttachmentsList /> */}\n      </div>\n    </AppContext.Provider>\n  );\n};\n\nApp.propTypes = {\n  title: PropTypes.string,\n};\n\nexport default App;","import * as React from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport App from \"./components/App\";\n\nconst title = \"Richards Law\";\nconst rootElement = document.getElementById(\"container\");\nconst root = rootElement ? createRoot(rootElement) : undefined;\n\nOffice.onReady(() => {\n  if (Office.context.mailbox) {\n    Office.context.mailbox.addHandlerAsync(\n      Office.EventType.ItemChanged,\n      () => {\n        window.dispatchEvent(new Event(\"emailChanged\"));\n      }\n    );\n  }\n\n  const renderApp = () => {\n    root?.render(<App title={title} />);\n  };\n\n  renderApp();\n\n  // Listen for OS theme changes and re-render\n  const media = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  media.addEventListener(\"change\", renderApp);\n});\n\n/* Hot Module Replacement */\nif (module.hot) {\n  module.hot.accept(\"./components/App\", () => {\n    const NextApp = require(\"./components/App\").default;\n    root?.render(<NextApp title={title} />);\n  });\n}\n"],"names":["ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","module","exports","shim","props","propName","componentName","location","propFullName","secret","err","Error","name","getShim","isRequired","ReactPropTypes","array","bigint","bool","func","number","object","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","m","createRoot","hydrateRoot","AppContext","createContext","isDark","colors","caseId","setCaseId","_ref","title","logo","message","messageStyle","marginTop","marginBottom","fontSize","fontWeight","color","React","textColor","textAlign","fontFamily","style","display","flexDirection","alignItems","paddingTop","backgroundColor","width","src","alt","height","onError","e","target","onerror","parentNode","innerHTML","App","_useState2","_slicedToArray","useState","window","matchMedia","matches","setIsDark","_useState4","attachments","setAttachments","_useState6","_useState8","officeReady","setOfficeReady","_useState0","item","setItem","_useState10","isComposeMode","setIsComposeMode","useEffect","Office","onReady","media","handleChange","addEventListener","removeEventListener","handler","_currentItem$body","currentItem","context","mailbox","isCompose","itemType","MailboxEnums","ItemType","Message","body","setAsync","mappedAttachments","filter","att","isInline","map","index","id","size","addHandlerAsync","EventType","ItemChanged","removeHandlerAsync","primaryColor","primaryColorHover","cardBackground","labelColor","borderColor","boxShadow","inputColor","inputBg","resultErrorColor","resultSuccessColor","warningColor","warningBg","listBg","listBorder","spinnerBorder","spinnerBorderTop","Provider","value","minHeight","Header","propTypes","rootElement","document","getElementById","root","undefined","dispatchEvent","Event","renderApp","render"],"ignoreList":[],"sourceRoot":""}