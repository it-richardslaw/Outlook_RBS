{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-react-js/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://office-addin-taskpane-react-js/./node_modules/react-dom/client.js","webpack://office-addin-taskpane-react-js/./node_modules/prop-types/index.js","webpack://office-addin-taskpane-react-js/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://office-addin-taskpane-react-js/./src/taskpane/components/AppContext.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/components/Header.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/components/AddNoteForm.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/components/App.jsx","webpack://office-addin-taskpane-react-js/./src/taskpane/index.jsx"],"sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","import { createContext } from \"react\";\r\n\r\nexport const AppContext = createContext({\r\n  isDark: false,\r\n  colors: {},\r\n  caseId: \"\",\r\n  setCaseId: () => {},\r\n});","import React, { useState } from 'react';\nimport { AppContext } from './AppContext';\n\n// --- Header Component (Adapted for compatibility) ---\nconst Header = ({ title, logo, message }) => {\n  const { colors } = React.useContext(AppContext); \n  // Styles translated from the Fluent UI \"makeStyles\" request\n  const headerStyle = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    paddingTop: \"10px\",\n    backgroundColor: \"transparent\", \n    width: \"100%\",\n  };\n\n  const messageStyle = {\n    marginTop: \"5px\",\n    marginBottom: \"15px\",\n    fontSize: \"42px\", \n    fontWeight: \"400\", \n    color: colors.textColor,\n    textAlign: \"center\",\n    fontFamily: \"'Segoe UI', sans-serif\",\n  };\n\n  return (\n    <section style={headerStyle}>\n      <img \n        src={logo} \n        alt={title} \n        style={{ width: \"90px\", height: \"auto\" }}\n        onError={(e) => {\n          e.target.onerror = null; \n          e.target.style.display = 'none';\n          e.target.parentNode.innerHTML += '<span style=\"font-size: 50px;\">⚖️</span>'; \n        }}\n      />\n      <h1 style={messageStyle}>{message}</h1>\n    </section>\n  );\n};\n\nexport default Header;","import React, { useState, useContext, useEffect } from \"react\";\r\nimport { AppContext } from \"./AppContext\";\r\n\r\nexport default function AddNoteForm() {\r\n  const { colors, caseId, setCaseId, item, isComposeMode } = useContext(AppContext);\r\n  const [deadline, setDeadline] = useState(\"\");\r\n  const [result, setResult] = useState(\"\");\r\n  const [isHovered, setIsHovered] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const spinnerStyle = {\r\n    border: `3px solid ${colors.spinnerBorder}`,\r\n    borderTop: `3px solid ${colors.spinnerBorderTop}`,\r\n    borderRadius: \"50%\",\r\n    width: \"9px\",\r\n    height: \"9px\",\r\n    animation: \"spin 1s linear infinite\",\r\n    display: \"inline-block\",\r\n    marginRight: \"8px\",\r\n  };\r\n\r\n  const keyframes = `\r\n    @keyframes spin {\r\n      0% { transform: rotate(0deg); }\r\n      100% { transform: rotate(360deg); }\r\n    }\r\n  `;\r\n\r\n  const getToday = () => {\r\n    const today = new Date();\r\n    const year = today.getFullYear();\r\n    const month = String(today.getMonth() + 1).padStart(2, \"0\");\r\n    const day = String(today.getDate()).padStart(2, \"0\");\r\n    return `${year}-${month}-${day}`;\r\n  };\r\n\r\n  const generateCorrelationId = () => {\r\n    return crypto.randomUUID().split(\"-\")[0];\r\n  };\r\n\r\n  const addCorrelationIdIfMissing = async (currentItem, correlationId) => {\r\n    return new Promise((resolve, reject) => {\r\n      currentItem.body.getAsync(Office.CoercionType.Html, (asyncResult) => {\r\n        if (asyncResult.status !== Office.AsyncResultStatus.Succeeded) {\r\n          reject(asyncResult.error);\r\n          return;\r\n        }\r\n\r\n        let bodyContent = asyncResult.value;\r\n\r\n        const correlationRegex = /\\[RBS-CID:([a-zA-Z0-9-]+)\\]/g;\r\n\r\n        const hasExisting = correlationRegex.test(bodyContent);\r\n\r\n        if (hasExisting) {\r\n          bodyContent = bodyContent.replace(correlationRegex, `[RBS-CID:${correlationId}]`);\r\n        } else {\r\n          const hiddenMarker = `\r\n            <span style=\"display:none;max-height:0;overflow:hidden;font-size:0;mso-hide:all;\">\r\n              [RBS-CID:${correlationId}]\r\n            </span>\r\n          `;\r\n          bodyContent = bodyContent + hiddenMarker;\r\n        }\r\n\r\n        currentItem.body.setAsync(\r\n          bodyContent,\r\n          { coercionType: Office.CoercionType.Html },\r\n          (setResult) => {\r\n            if (setResult.status === Office.AsyncResultStatus.Succeeded) {\r\n              resolve(correlationId);\r\n            } else {\r\n              reject(setResult.error);\r\n            }\r\n          }\r\n        );\r\n      });\r\n    });\r\n  };\r\n\r\n  const fetchCaseByCorrelationId = async (correlationId) => {\r\n    try {\r\n      const emailAddress = Office.context.mailbox.userProfile.emailAddress;\r\n      const payload = {\r\n        CorrelationID: correlationId,\r\n        Email: emailAddress,\r\n      };\r\n      const response = await fetch(\r\n        \"https://outlook-rbs.it-bed.workers.dev/findCaseIDByCorrelationID\",\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(payload),\r\n        }\r\n      );\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const text = JSON.parse(data.text);\r\n        if (text.CaseID) {\r\n          setCaseId(text.CaseID);\r\n        } else {\r\n          setCaseId(\"\");\r\n        }\r\n      } else {\r\n        setCaseId(\"\");\r\n      }\r\n    } catch (error) {\r\n      setCaseId(\"\");\r\n    }\r\n  };\r\n\r\n  const tryFindCaseIdFromCompose = (item) => {\r\n    item.body.getAsync(Office.CoercionType.Html, (result) => {\r\n      if (result.status !== Office.AsyncResultStatus.Succeeded) return;\r\n\r\n      const body = result.value;\r\n      // Look for your CaseID or CID marker\r\n      const cidMatch = body.match(/\\[RBS-CID:([A-Za-z0-9-]+)\\]/);\r\n\r\n      if (cidMatch) {\r\n        fetchCaseByCorrelationId(cidMatch[1]);\r\n      } else {\r\n        setCaseId(\"\");\r\n      }\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    setDeadline(getToday());\r\n\r\n    if (!item) {\r\n      setCaseId(\"\");\r\n      setResult(\"\");\r\n      return;\r\n    }\r\n\r\n    setCaseId(\"\");\r\n    setResult(\"\");\r\n\r\n    if (!isComposeMode) {\r\n      getCaseID();\r\n    } else {\r\n      tryFindCaseIdFromCompose(item);\r\n    }\r\n  }, [item, isComposeMode, getCaseID]);\r\n\r\n  const getCaseID = async () => {\r\n    setResult(\"\");\r\n    try {\r\n      const currentItem = item;\r\n      if (!currentItem) {\r\n        return;\r\n      }\r\n      const messageId = currentItem.itemId;\r\n      const emailAddress = Office.context.mailbox.userProfile.emailAddress;\r\n      const conversationId = currentItem.conversationId;\r\n      const internetMessageId = currentItem.internetMessageId;\r\n      if (!messageId && !conversationId && !internetMessageId) {\r\n        return;\r\n      }\r\n      const payload = {\r\n        MessageID: messageId,\r\n        Email: emailAddress,\r\n        ConversationID: conversationId,\r\n        InternetMessageID: internetMessageId,\r\n      };\r\n      const response = await fetch(\"https://outlook-rbs.it-bed.workers.dev/findCaseID\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const text = JSON.parse(data.text);\r\n  \r\n        setCaseId((prev) => {\r\n          if (prev.trim() === \"\") {\r\n            return text.CaseID ? text.CaseID : \"\";\r\n          }\r\n          return prev;\r\n        });\r\n        if (text.Users && Array.isArray(text.Users) && text.Users.length > 0) {\r\n          setResult(`A note has already been created for this email by: ${text.Users.join(\", \")}`);\r\n        } else {\r\n          setResult(\"\");\r\n        }\r\n      } else {\r\n        const text = await response.text();\r\n        setResult(\"❌ Error: \" + text);\r\n      }\r\n    } catch (error) {\r\n      setResult(\"❌ Error: \" + error.message);\r\n    }\r\n  };\r\n\r\n  const addNote = async () => {\r\n    try {\r\n      if (isLoading) return;\r\n\r\n      if (!caseId || !deadline) {\r\n        setResult(\"❌ Please fill in all fields.\");\r\n        return;\r\n      }\r\n      const currentItem = item;\r\n      if (!currentItem) {\r\n        setResult(\"❌ No email item found.\");\r\n        return;\r\n      }\r\n\r\n      const messageId = currentItem.itemId;\r\n      const emailAddress = Office.context.mailbox.userProfile.emailAddress;\r\n      if (!messageId) {\r\n        setResult(\"❌ Cannot add note for draft email.\");\r\n        return;\r\n      }\r\n      setResult(\"\");\r\n      setIsLoading(true);\r\n\r\n      const payload = {\r\n        CaseID: caseId,\r\n        Deadline: deadline,\r\n        MessageID: messageId,\r\n        Email: emailAddress,\r\n      };\r\n      const response = await fetch(\"https://outlook-rbs.it-bed.workers.dev/createNote\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      if (response.ok) {\r\n        setIsLoading(false);\r\n        const data = await response.json();\r\n        const text = JSON.parse(data.text);\r\n        if (\"Error\" in text) {\r\n          setResult(\"❌ Error: \" + text.Error);\r\n          return;\r\n        }\r\n\r\n        setResult(\"✅ Note created successfully!\");\r\n      } else {\r\n        setIsLoading(false);\r\n        const text = await response.text();\r\n        setResult(\"❌ Error: \" + text);\r\n      }\r\n    } catch (error) {\r\n      setIsLoading(false);\r\n      setResult(\"❌ Error: \" + error.message);\r\n    }\r\n  };\r\n\r\n  const sendAndAddNote = async () => {\r\n    if (isLoading) return;\r\n\r\n    if (!caseId || !deadline) {\r\n      setResult(\"❌ Please fill in all fields.\");\r\n      return;\r\n    }\r\n\r\n    const currentItem = item;\r\n    if (!currentItem) {\r\n      setResult(\"❌ No email item found.\");\r\n      return;\r\n    }\r\n\r\n    setResult(\"\");\r\n    setIsLoading(true);\r\n\r\n    const correlationId = generateCorrelationId();\r\n    await addCorrelationIdIfMissing(currentItem, correlationId);\r\n\r\n    const emailAddress = Office.context.mailbox.userProfile.emailAddress;\r\n    const payload = {\r\n      CaseID: caseId,\r\n      Deadline: deadline,\r\n      Email: emailAddress,\r\n      CorrelationID: correlationId,\r\n    };\r\n\r\n    const response = await fetch(\"https://outlook-rbs.it-bed.workers.dev/createNoteFromCompose\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(payload),\r\n    });\r\n\r\n    if (response.ok) {\r\n      setIsLoading(false);\r\n      const data = await response.json();\r\n      const text = JSON.parse(data.text);\r\n      if (\"Error\" in text) {\r\n        setResult(\"❌ Error: \" + text.Error);\r\n        return;\r\n      }\r\n\r\n      setResult(\"✅ Note created successfully!\");\r\n    } else {\r\n      setIsLoading(false);\r\n      const text = await response.text();\r\n\r\n      setResult(\"❌ Error: \" + text);\r\n    }\r\n\r\n    await new Promise((resolve, reject) => {\r\n      currentItem.sendAsync((result) => {\r\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\r\n          resolve();\r\n        } else {\r\n          reject(result.error);\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  const mainButtonStyles = {\r\n    padding: \"12px 15px\",\r\n    borderRadius: \"6px\",\r\n    border: \"none\",\r\n    color: \"#fff\",\r\n    fontWeight: \"bold\",\r\n    fontSize: \"14px\",\r\n    transition: \"background-color 0.2s ease, transform 0.1s ease\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    width: \"100%\",\r\n    backgroundColor: isLoading\r\n      ? colors.primaryColorHover\r\n      : isHovered\r\n        ? colors.primaryColorHover\r\n        : colors.primaryColor,\r\n    cursor: isLoading ? \"not-allowed\" : \"pointer\",\r\n  };\r\n\r\n  const buttonText = isComposeMode ? \"Send Email and Add Note\" : \"Add Note\";\r\n  const buttonAction = isComposeMode ? sendAndAddNote : addNote;\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"flex-start\",\r\n        fontFamily: \"Roboto, 'Segoe UI', sans-serif\",\r\n        backgroundColor: \"transparent\",\r\n        margin: 0,\r\n        padding: \"0 10px 10px 10px\",\r\n        color: colors.textColor,\r\n      }}\r\n    >\r\n      <style>{keyframes}</style>\r\n\r\n      <div\r\n        style={{\r\n          width: \"100%\",\r\n          maxWidth: \"480px\",\r\n          padding: \"0 30px 10px 30px\",\r\n        }}\r\n      >\r\n        <h2\r\n          style={{\r\n            textAlign: \"center\",\r\n            marginBottom: \"30px\",\r\n            marginTop: \"0\",\r\n            color: colors.textColor,\r\n          }}\r\n        >\r\n          Add New Note\r\n        </h2>\r\n\r\n        {/* Input Group 1: CaseID */}\r\n        <div style={{ marginBottom: \"20px\" }}>\r\n          <label\r\n            style={{\r\n              display: \"block\",\r\n              marginBottom: \"8px\",\r\n              fontWeight: \"600\",\r\n              color: colors.labelColor,\r\n              fontSize: \"14px\",\r\n            }}\r\n          >\r\n            Case ID\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={caseId}\r\n            onChange={(e) => setCaseId(e.target.value)}\r\n            placeholder=\"e.g., T12345\"\r\n            style={{\r\n              width: \"100%\",\r\n              padding: \"12px 12px\",\r\n              borderRadius: \"6px\",\r\n              border: `1px solid ${colors.borderColor}`,\r\n              boxSizing: \"border-box\",\r\n              fontSize: \"14px\",\r\n              outline: \"none\",\r\n              color: colors.inputColor,\r\n              backgroundColor: colors.inputBg,\r\n            }}\r\n            onFocus={(e) => (e.target.style.borderColor = colors.primaryColor)}\r\n            onBlur={(e) => (e.target.style.borderColor = colors.borderColor)}\r\n          />\r\n        </div>\r\n\r\n        {/* Input Group 2: Deadline */}\r\n        <div style={{ marginBottom: \"30px\" }}>\r\n          <label\r\n            style={{\r\n              display: \"block\",\r\n              marginBottom: \"8px\",\r\n              fontWeight: \"600\",\r\n              color: colors.labelColor,\r\n              fontSize: \"14px\",\r\n            }}\r\n          >\r\n            Deadline\r\n          </label>\r\n          <input\r\n            type=\"date\"\r\n            value={deadline}\r\n            onChange={(e) => setDeadline(e.target.value)}\r\n            style={{\r\n              width: \"100%\",\r\n              padding: \"12px 12px\",\r\n              borderRadius: \"6px\",\r\n              border: `1px solid ${colors.borderColor}`,\r\n              boxSizing: \"border-box\",\r\n              fontSize: \"14px\",\r\n              outline: \"none\",\r\n              color: colors.inputColor,\r\n              backgroundColor: colors.inputBg,\r\n            }}\r\n            onFocus={(e) => (e.target.style.borderColor = colors.primaryColor)}\r\n            onBlur={(e) => (e.target.style.borderColor = colors.borderColor)}\r\n          />\r\n        </div>\r\n        <div style={{ display: \"flex\", gap: \"10px\", marginBottom: \"20px\" }}>\r\n          <button\r\n            onClick={buttonAction}\r\n            disabled={isLoading}\r\n            style={mainButtonStyles}\r\n            onMouseEnter={() => setIsHovered(true)}\r\n            onMouseLeave={() => setIsHovered(false)}\r\n            onMouseDown={(e) => (e.currentTarget.style.transform = \"scale(0.98)\")}\r\n            onMouseUp={(e) => (e.currentTarget.style.transform = \"scale(1)\")}\r\n          >\r\n            {isLoading && <span style={spinnerStyle}></span>}\r\n            {isLoading ? (isComposeMode ? \"Sending & Saving...\" : \"Saving...\") : buttonText}\r\n          </button>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            textAlign: \"center\",\r\n            fontSize: \"14px\",\r\n            color: result.startsWith(\"❌\") ? colors.resultErrorColor : colors.resultSuccessColor,\r\n            minHeight: \"20px\",\r\n          }}\r\n        >\r\n          <span>{result}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import * as React from \"react\";\nimport { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Header from \"./Header\";\nimport AddNoteForm from \"./AddNoteForm\";\nimport { AppContext } from \"./AppContext\";\nimport AttachmentsList from \"./AttachmentsList\";\n\nfunction isDarkTheme() {\n  return typeof window !== \"undefined\" && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n}\n\nconst App = (props) => {\n  const { title } = props;\n  const [isDark, setIsDark] = useState(isDarkTheme());\n  const [attachments, setAttachments] = useState([]);\n  const [caseId, setCaseId] = useState(\"\");\n  const [officeReady, setOfficeReady] = useState(false);\n  const [item, setItem] = useState(null);\n  const [isComposeMode, setIsComposeMode] = useState(false);\n\n  useEffect(() => {\n    Office.onReady(() => {\n      setOfficeReady(true);\n    });\n  }, []);\n\n  useEffect(() => {\n    const media = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    const handleChange = (e) => {\n      setIsDark(e.matches);\n    };\n    media.addEventListener(\"change\", handleChange);\n    return () => media.removeEventListener(\"change\", handleChange);\n  }, []);\n\n  useEffect(() => {\n    const handler = () => {\n      const currentItem = Office.context.mailbox.item;\n      if (!currentItem) {\n        setAttachments([]);\n        return;\n      }\n\n      setItem(currentItem);\n      const isCompose =\n        currentItem.itemType === Office.MailboxEnums.ItemType.Message &&\n        typeof currentItem.body?.setAsync === \"function\";\n      setIsComposeMode(isCompose);\n\n      if (!currentItem.attachments) {\n        setAttachments([]);\n        return;\n      }\n\n      const mappedAttachments = currentItem.attachments\n        .filter((att) => !att.isInline)\n        .map((att, index) => ({\n          id: att.id || index,\n          name: att.name,\n          size: att.size || 0,\n        }));\n      setAttachments(mappedAttachments);\n    };\n\n    handler();\n\n    Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, handler);\n\n    return () => Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged, handler);\n  }, []);\n\n  const colors = {\n    primaryColor: \"#1070e0\",\n    primaryColorHover: \"#0d5fb5\",\n    backgroundColor: isDark ? \"#1f1f1f\" : \"#f5f5f5\",\n    cardBackground: isDark ? \"#2d2d2d\" : \"#fff\",\n    textColor: isDark ? \"#f0f0f0\" : \"#333\",\n    labelColor: isDark ? \"#ccc\" : \"#555\",\n    borderColor: isDark ? \"#444\" : \"#d1d9e6\",\n    boxShadow: isDark ? \"0 6px 20px rgba(0,0,0,0.3)\" : \"0 6px 20px rgba(0,0,0,0.05)\",\n    inputColor: isDark ? \"#e0e0e0\" : \"#333\",\n    inputBg: isDark ? \"#3c3c3c\" : \"#fff\",\n    resultErrorColor: isDark ? \"#ff7f7f\" : \"#d32f2f\",\n    resultSuccessColor: isDark ? \"#90ee90\" : \"#2e7d32\",\n    warningColor: isDark ? \"#ffeb3b\" : \"#ff9800\",\n    warningBg: isDark ? \"#4c3f00\" : \"#fff3e0\",\n    listBg: isDark ? \"#242424\" : \"#f9f9f9\",\n    listBorder: isDark ? \"#333\" : \"#eee\",\n    spinnerBorder: isDark ? \"#555\" : \"#f3f3f3\",\n    spinnerBorderTop: \"#fff\",\n  };\n\n  if (!officeReady) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <AppContext.Provider\n      value={{ isDark, colors, caseId, setCaseId, item, setItem, isComposeMode, attachments }}\n    >\n      <div style={{ backgroundColor: \"transparent\", minHeight: \"100vh\" }}>\n        <Header logo=\"assets/logo-filled.png\" title={title} message=\"Richards Law\" />\n        <AddNoteForm />\n        {/* <AttachmentsList /> */}\n      </div>\n    </AppContext.Provider>\n  );\n};\n\nApp.propTypes = {\n  title: PropTypes.string,\n};\n\nexport default App;","import * as React from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport App from \"./components/App\";\n\nconst title = \"Richards Law\";\nconst rootElement = document.getElementById(\"container\");\nconst root = rootElement ? createRoot(rootElement) : undefined;\n\nOffice.onReady(() => {\n  if (Office.context.mailbox) {\n    Office.context.mailbox.addHandlerAsync(\n      Office.EventType.ItemChanged,\n      () => {\n        window.dispatchEvent(new Event(\"emailChanged\"));\n      }\n    );\n  }\n\n  const renderApp = () => {\n    root?.render(<App title={title} />);\n  };\n\n  renderApp();\n\n  // Listen for OS theme changes and re-render\n  const media = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  media.addEventListener(\"change\", renderApp);\n});\n\n/* Hot Module Replacement */\nif (module.hot) {\n  module.hot.accept(\"./components/App\", () => {\n    const NextApp = require(\"./components/App\").default;\n    root?.render(<NextApp title={title} />);\n  });\n}\n"],"names":["ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","module","exports","shim","props","propName","componentName","location","propFullName","secret","err","Error","name","getShim","isRequired","ReactPropTypes","array","bigint","bool","func","number","object","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","m","createRoot","hydrateRoot","AppContext","createContext","isDark","colors","caseId","setCaseId","_ref","title","logo","message","messageStyle","marginTop","marginBottom","fontSize","fontWeight","color","React","textColor","textAlign","fontFamily","style","display","flexDirection","alignItems","paddingTop","backgroundColor","width","src","alt","height","onError","e","target","onerror","parentNode","innerHTML","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_arrayLikeToArray","toString","slice","constructor","from","test","_unsupportedIterableToArray","_nonIterableRest","AddNoteForm","_useContext","useContext","item","isComposeMode","_useState2","useState","deadline","setDeadline","_useState4","result","setResult","_useState6","isHovered","setIsHovered","_useState8","isLoading","setIsLoading","spinnerStyle","border","concat","spinnerBorder","borderTop","spinnerBorderTop","borderRadius","animation","marginRight","generateCorrelationId","crypto","randomUUID","split","addCorrelationIdIfMissing","_callee","currentItem","correlationId","_context","reject","body","getAsync","Office","CoercionType","Html","asyncResult","status","AsyncResultStatus","Succeeded","bodyContent","correlationRegex","replace","setAsync","coercionType","error","_x","_x2","fetchCaseByCorrelationId","_ref2","_callee2","emailAddress","payload","response","data","text","_context2","context","mailbox","userProfile","CorrelationID","Email","fetch","method","headers","JSON","stringify","ok","json","parse","CaseID","_x3","useEffect","today","year","month","day","Date","getFullYear","String","getMonth","padStart","getDate","cidMatch","match","tryFindCaseIdFromCompose","getCaseID","_ref3","_callee3","messageId","conversationId","internetMessageId","_text","_t2","_context3","itemId","MessageID","ConversationID","InternetMessageID","prev","trim","Users","join","addNote","_ref4","_callee4","_text2","_t3","_context4","Deadline","sendAndAddNote","_ref5","_callee5","_text3","_context5","sendAsync","mainButtonStyles","padding","transition","justifyContent","primaryColorHover","primaryColor","cursor","buttonText","buttonAction","margin","maxWidth","labelColor","type","onChange","placeholder","borderColor","boxSizing","outline","inputColor","inputBg","onFocus","onBlur","gap","onClick","disabled","onMouseEnter","onMouseLeave","onMouseDown","currentTarget","transform","onMouseUp","startsWith","resultErrorColor","resultSuccessColor","minHeight","App","window","matchMedia","matches","setIsDark","attachments","setAttachments","officeReady","setOfficeReady","_useState0","setItem","_useState10","setIsComposeMode","onReady","media","handleChange","addEventListener","removeEventListener","handler","_currentItem$body","isCompose","itemType","MailboxEnums","ItemType","Message","mappedAttachments","filter","att","isInline","map","index","id","size","addHandlerAsync","EventType","ItemChanged","removeHandlerAsync","cardBackground","boxShadow","warningColor","warningBg","listBg","listBorder","Provider","Header","propTypes","rootElement","document","getElementById","root","undefined","dispatchEvent","Event","renderApp","render"],"ignoreList":[],"sourceRoot":""}